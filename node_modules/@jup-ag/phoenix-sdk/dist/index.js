"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { newObj[key] = obj[key]; } } } newObj.default = obj; return newObj; } } function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }var Or=Object.defineProperty;var Mt=Object.getOwnPropertySymbols;var Br=Object.prototype.hasOwnProperty,Fr=Object.prototype.propertyIsEnumerable;var v=Math.pow,Nt=(e,t,r)=>t in e?Or(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l=(e,t)=>{for(var r in t||(t={}))Br.call(t,r)&&Nt(e,r,t[r]);if(Mt)for(var r of Mt(t))Fr.call(t,r)&&Nt(e,r,t[r]);return e};var w=(e,t,r)=>new Promise((o,n)=>{var a=i=>{try{u(r.next(i))}catch(c){n(c)}},s=i=>{try{u(r.throw(i))}catch(c){n(c)}},u=i=>i.done?o(i.value):Promise.resolve(i.value).then(a,s);u((r=r.apply(e,t)).next())});var _web3js = require('@solana/web3.js'); var Ee = _interopRequireWildcard(_web3js); var Ue = _interopRequireWildcard(_web3js); var De = _interopRequireWildcard(_web3js); var Ce = _interopRequireWildcard(_web3js); var Ne = _interopRequireWildcard(_web3js); var Ge = _interopRequireWildcard(_web3js); var Ve = _interopRequireWildcard(_web3js); var He = _interopRequireWildcard(_web3js); var Xe = _interopRequireWildcard(_web3js); var Je = _interopRequireWildcard(_web3js); var $e = _interopRequireWildcard(_web3js); var tt = _interopRequireWildcard(_web3js); var it = _interopRequireWildcard(_web3js); var ot = _interopRequireWildcard(_web3js); var le = _interopRequireWildcard(_web3js); var ut = _interopRequireWildcard(_web3js); var lt = _interopRequireWildcard(_web3js); var mt = _interopRequireWildcard(_web3js);var d=new Map,p=new Map,C= exports.InvalidMarketParametersError =class extends Error{constructor(){super("Invalid market parameters error");this.code=0;this.name="InvalidMarketParameters";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,C)}};d.set(0,()=>new C);p.set("InvalidMarketParameters",()=>new C);var M=class extends Error{constructor(){super("Invalid exchange authority error");this.code=1;this.name="InvalidMarketAuthority";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,M)}};d.set(1,()=>new M);p.set("InvalidMarketAuthority",()=>new M);var N=class extends Error{constructor(){super("Market deserialization error");this.code=2;this.name="FailedToLoadMarketFromAccount";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,N)}};d.set(2,()=>new N);p.set("FailedToLoadMarketFromAccount",()=>new N);var z=class extends Error{constructor(){super("Market already initialized error");this.code=3;this.name="MarketAlreadyInitialized";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,z)}};d.set(3,()=>new z);p.set("MarketAlreadyInitialized",()=>new z);var G=class extends Error{constructor(){super("Market is not initialized error");this.code=4;this.name="MarketUninitialized";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,G)}};d.set(4,()=>new G);p.set("MarketUninitialized",()=>new G);var j=class extends Error{constructor(){super("Invalid state transition error");this.code=5;this.name="InvalidStateTransition";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,j)}};d.set(5,()=>new j);p.set("InvalidStateTransition",()=>new j);var V=class extends Error{constructor(){super("Invalid market signer error");this.code=6;this.name="InvalidMarketSigner";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,V)}};d.set(6,()=>new V);p.set("InvalidMarketSigner",()=>new V);var Y=class extends Error{constructor(){super("Invalid lot size error");this.code=7;this.name="InvalidLotSize";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Y)}};d.set(7,()=>new Y);p.set("InvalidLotSize",()=>new Y);var H=class extends Error{constructor(){super("Invalid tick size error");this.code=8;this.name="InvalidTickSize";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,H)}};d.set(8,()=>new H);p.set("InvalidTickSize",()=>new H);var Z=class extends Error{constructor(){super("Invalid mint error");this.code=9;this.name="InvalidMint";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Z)}};d.set(9,()=>new Z);p.set("InvalidMint",()=>new Z);var X=class extends Error{constructor(){super("Invalid base vault error");this.code=10;this.name="InvalidBaseVault";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,X)}};d.set(10,()=>new X);p.set("InvalidBaseVault",()=>new X);var Q=class extends Error{constructor(){super("Invalid quote vault error");this.code=11;this.name="InvalidQuoteVault";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Q)}};d.set(11,()=>new Q);p.set("InvalidQuoteVault",()=>new Q);var J=class extends Error{constructor(){super("Invalid base account error");this.code=12;this.name="InvalidBaseAccount";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,J)}};d.set(12,()=>new J);p.set("InvalidBaseAccount",()=>new J);var _=class extends Error{constructor(){super("Invalid quote account error");this.code=13;this.name="InvalidQuoteAccount";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,_)}};d.set(13,()=>new _);p.set("InvalidQuoteAccount",()=>new _);var $=class extends Error{constructor(){super("Too many events error");this.code=14;this.name="TooManyEvents";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,$)}};d.set(14,()=>new $);p.set("TooManyEvents",()=>new $);var ee=class extends Error{constructor(){super("New order error");this.code=15;this.name="NewOrderError";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ee)}};d.set(15,()=>new ee);p.set("NewOrderError",()=>new ee);var te=class extends Error{constructor(){super("Reduce order error");this.code=16;this.name="ReduceOrderError";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,te)}};d.set(16,()=>new te);p.set("ReduceOrderError",()=>new te);var re=class extends Error{constructor(){super("Cancel multiple orders error");this.code=17;this.name="CancelMultipleOrdersError";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,re)}};d.set(17,()=>new re);p.set("CancelMultipleOrdersError",()=>new re);var ie=class extends Error{constructor(){super("Withdraw funds error");this.code=18;this.name="WithdrawFundsError";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ie)}};d.set(18,()=>new ie);p.set("WithdrawFundsError",()=>new ie);var ne=class extends Error{constructor(){super("Remove empty orders error");this.code=19;this.name="RemoveEmptyOrdersError";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ne)}};d.set(19,()=>new ne);p.set("RemoveEmptyOrdersError",()=>new ne);var oe=class extends Error{constructor(){super("Trader not found error");this.code=20;this.name="TraderNotFound";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,oe)}};d.set(20,()=>new oe);p.set("TraderNotFound",()=>new oe);var se=class extends Error{constructor(){super("Invalid seat status");this.code=21;this.name="InvalidSeatStatus";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,se)}};d.set(21,()=>new se);p.set("InvalidSeatStatus",()=>new se);var ae=class extends Error{constructor(){super("Failed to evict trader");this.code=22;this.name="EvictionError";typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ae)}};d.set(22,()=>new ae);p.set("EvictionError",()=>new ae);function Ai(e){let t=d.get(e);return t!=null?t():null}function hi(e){let t=p.get(e);return t!=null?t():null}var _beet = require('@metaplex-foundation/beet'); var A = _interopRequireWildcard(_beet); var Ie = _interopRequireWildcard(_beet); var ye = _interopRequireWildcard(_beet); var zt = _interopRequireWildcard(_beet); var h = _interopRequireWildcard(_beet); var fe = _interopRequireWildcard(_beet); var ge = _interopRequireWildcard(_beet); var E = _interopRequireWildcard(_beet); var ue = _interopRequireWildcard(_beet); var T = _interopRequireWildcard(_beet); var B = _interopRequireWildcard(_beet); var g = _interopRequireWildcard(_beet); var ce = _interopRequireWildcard(_beet); var ke = _interopRequireWildcard(_beet); var Ht = _interopRequireWildcard(_beet); var I = _interopRequireWildcard(_beet); var b = _interopRequireWildcard(_beet); var Xt = _interopRequireWildcard(_beet); var Qt = _interopRequireWildcard(_beet); var F = _interopRequireWildcard(_beet); var L = _interopRequireWildcard(_beet); var Le = _interopRequireWildcard(_beet); var U = _interopRequireWildcard(_beet); var Jt = _interopRequireWildcard(_beet); var R = _interopRequireWildcard(_beet); var We = _interopRequireWildcard(_beet); var qe = _interopRequireWildcard(_beet); var Re = _interopRequireWildcard(_beet); var ve = _interopRequireWildcard(_beet); var Me = _interopRequireWildcard(_beet); var ze = _interopRequireWildcard(_beet); var je = _interopRequireWildcard(_beet); var Ye = _interopRequireWildcard(_beet); var Ze = _interopRequireWildcard(_beet); var Qe = _interopRequireWildcard(_beet); var _e = _interopRequireWildcard(_beet); var et = _interopRequireWildcard(_beet); var rt = _interopRequireWildcard(_beet); var nt = _interopRequireWildcard(_beet); var st = _interopRequireWildcard(_beet); var at = _interopRequireWildcard(_beet); var ct = _interopRequireWildcard(_beet); var bt = _interopRequireWildcard(_beet); var y = _interopRequireWildcard(_beet);var _beetsolana = require('@metaplex-foundation/beet-solana'); var Pt = _interopRequireWildcard(_beetsolana); var jt = _interopRequireWildcard(_beetsolana); var Vt = _interopRequireWildcard(_beetsolana); var Fe = _interopRequireWildcard(_beetsolana); var St = _interopRequireWildcard(_beetsolana); var Ft = _interopRequireWildcard(_beetsolana); var lr = _interopRequireWildcard(_beetsolana);var Oi=new A.BeetArgsStruct([["instruction",A.u8],["sequenceNumber",A.u64],["timestamp",A.i64],["slot",A.u64],["market",Pt.publicKey],["signer",Pt.publicKey],["totalEvents",A.u16]],"AuditLogHeader");var xt=(r=>(r[r.Bid=0]="Bid",r[r.Ask=1]="Ask",r))(xt||{}),W= exports.sideBeet =zt.fixedScalarEnum(xt);var he=new ye.BeetArgsStruct([["side",W],["priceInTicks",ye.u64],["orderSequenceNumber",ye.u64]],"CancelOrderParams");var Oe=new Ie.FixableBeetArgsStruct([["orders",Ie.array(he)]],"CancelMultipleOrdersByIdParams");var Be=new h.FixableBeetArgsStruct([["side",W],["tickLimit",h.coption(h.u64)],["numOrdersToSearch",h.coption(h.u32)],["numOrdersToCancel",h.coption(h.u32)]],"CancelUpToParams");var wt=new fe.BeetArgsStruct([["priceInTicks",fe.u64],["sizeInBaseLots",fe.u64]],"CondensedOrder");var Gt=new ge.BeetArgsStruct([["quoteLotsToDeposit",ge.u64],["baseLotsToDeposit",ge.u64]],"DepositParams");var Mi=new E.BeetArgsStruct([["index",E.u16],["makerId",jt.publicKey],["orderSequenceNumber",E.u64],["priceInTicks",E.u64],["baseLotsEvicted",E.u64]],"EvictEvent");var zi=new ue.BeetArgsStruct([["index",ue.u16],["feesCollectedInQuoteLots",ue.u64]],"FeeEvent");var ji=new T.BeetArgsStruct([["index",T.u16],["makerId",Vt.publicKey],["orderSequenceNumber",T.u64],["priceInTicks",T.u64],["baseLotsFilled",T.u64],["baseLotsRemaining",T.u64]],"FillEvent");var Yi=new B.BeetArgsStruct([["index",B.u16],["clientOrderId",B.u128],["totalBaseLotsFilled",B.u64],["totalQuoteLotsFilled",B.u64],["totalFeeInQuoteLots",B.u64]],"FillSummaryEvent");var Yt=new ce.BeetArgsStruct([["bidsSize",ce.u64],["asksSize",ce.u64],["numSeats",ce.u64]],"MarketSizeParams");var At=new ke.BeetArgsStruct([["decimals",ke.u32],["vaultBump",ke.u32],["mintKey",St.publicKey],["vaultKey",St.publicKey]],"TokenParams");var ht=new g.BeetArgsStruct([["discriminant",g.u64],["status",g.u64],["marketSizeParams",Yt],["baseParams",At],["baseLotSize",g.u64],["quoteParams",At],["quoteLotSize",g.u64],["tickSizeInQuoteAtomsPerBaseUnit",g.u64],["authority",Fe.publicKey],["feeRecipient",Fe.publicKey],["marketSequenceNumber",g.u64],["successor",Fe.publicKey],["rawBaseUnitsPerBaseUnit",g.u32],["padding1",g.u32],["padding2",g.uniformFixedSizeArray(g.u64,32)]],"MarketHeader");var Zt=(s=>(s[s.Uninitialized=0]="Uninitialized",s[s.Active=1]="Active",s[s.PostOnly=2]="PostOnly",s[s.Paused=3]="Paused",s[s.Closed=4]="Closed",s[s.Tombstoned=5]="Tombstoned",s))(Zt||{}),tn= exports.marketStatusBeet =Ht.fixedScalarEnum(Zt);var Te=new I.FixableBeetArgsStruct([["bids",I.array(wt)],["asks",I.array(wt)],["clientOrderId",I.coption(I.u128)],["rejectPostOnly",I.bool]],"MultipleOrderPacket");var It=(o=>(o[o.Abort=0]="Abort",o[o.CancelProvide=1]="CancelProvide",o[o.DecrementTake=2]="DecrementTake",o))(It||{}),Ot= exports.selfTradeBehaviorBeet =Xt.fixedScalarEnum(It);var mn=e=>e.__kind==="PostOnly",dn= exports.isOrderPacketLimit =e=>e.__kind==="Limit",pn= exports.isOrderPacketImmediateOrCancel =e=>e.__kind==="ImmediateOrCancel",q= exports.orderPacketBeet =b.dataEnum([["PostOnly",new b.BeetArgsStruct([["side",W],["priceInTicks",b.u64],["numBaseLots",b.u64],["clientOrderId",b.u128],["rejectPostOnly",b.bool],["useOnlyDepositedFunds",b.bool]],'OrderPacketRecord["PostOnly"]')],["Limit",new b.FixableBeetArgsStruct([["side",W],["priceInTicks",b.u64],["numBaseLots",b.u64],["selfTradeBehavior",Ot],["matchLimit",b.coption(b.u64)],["clientOrderId",b.u128],["useOnlyDepositedFunds",b.bool]],'OrderPacketRecord["Limit"]')],["ImmediateOrCancel",new b.FixableBeetArgsStruct([["side",W],["priceInTicks",b.coption(b.u64)],["numBaseLots",b.u64],["numQuoteLots",b.u64],["minBaseLotsToFill",b.u64],["minQuoteLotsToFill",b.u64],["selfTradeBehavior",Ot],["matchLimit",b.coption(b.u64)],["clientOrderId",b.u128],["useOnlyDepositedFunds",b.bool]],'OrderPacketRecord["ImmediateOrCancel"]')]]);var Bt=(i=>(i[i.Uninitialized=0]="Uninitialized",i[i.Header=1]="Header",i[i.Fill=2]="Fill",i[i.Place=3]="Place",i[i.Reduce=4]="Reduce",i[i.Evict=5]="Evict",i[i.FillSummary=6]="FillSummary",i[i.Fee=7]="Fee",i))(Bt||{}),fn= exports.phoenixMarketEventBeet =Qt.fixedScalarEnum(Bt);var kn=new F.BeetArgsStruct([["index",F.u16],["orderSequenceNumber",F.u64],["clientOrderId",F.u128],["priceInTicks",F.u64],["baseLotsPlaced",F.u64]],"PlaceEvent");var xn=new L.BeetArgsStruct([["index",L.u16],["orderSequenceNumber",L.u64],["priceInTicks",L.u64],["baseLotsRemoved",L.u64],["baseLotsRemaining",L.u64]],"ReduceEvent");var Ke=new Le.BeetArgsStruct([["baseParams",he],["size",Le.u64]],"ReduceOrderParams");var In=new U.BeetArgsStruct([["discriminant",U.u64],["market",Ft.publicKey],["trader",Ft.publicKey],["approvalStatus",U.u64],["padding",U.uniformFixedSizeArray(U.u64,16)]],"Seat");var _t=(o=>(o[o.NotApproved=0]="NotApproved",o[o.Approved=1]="Approved",o[o.Retired=2]="Retired",o))(_t||{}),Bn= exports.seatApprovalStatusBeet =Jt.fixedScalarEnum(_t);var $t=new R.FixableBeetArgsStruct([["quoteLotsToWithdraw",R.coption(R.u64)],["baseLotsToWithdraw",R.coption(R.u64)]],"WithdrawParams");var _bnjs = require('bn.js'); var _bnjs2 = _interopRequireDefault(_bnjs);function S(e){let t;return typeof e=="number"?t=e:t=e.toNumber(),t}function K(e){return typeof e=="number"?new (0, _bnjs2.default)(e):e.clone()}function Lt(e){return e.lt(new (0, _bnjs2.default)(0))?-1:e.gt(new (0, _bnjs2.default)(0))?1:0}var _spltoken = require('@solana/spl-token'); var er = _interopRequireWildcard(_spltoken); var tr = _interopRequireWildcard(_spltoken); var rr = _interopRequireWildcard(_spltoken); var ir = _interopRequireWildcard(_spltoken); var nr = _interopRequireWildcard(_spltoken); var or = _interopRequireWildcard(_spltoken); var sr = _interopRequireWildcard(_spltoken); var ar = _interopRequireWildcard(_spltoken); var cr = _interopRequireWildcard(_spltoken);var Tr=new We.BeetArgsStruct([["instructionDiscriminator",We.u8]],"CancelAllOrdersInstructionArgs"),Lr= exports.cancelAllOrdersInstructionDiscriminator =6;function no(e,t=new Ee.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var a;let[r]=Tr.serialize({instructionDiscriminator:Lr}),o=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(a=e.tokenProgram)!=null?a:er.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new Ee.TransactionInstruction({programId:t,keys:o,data:r})}var Kr=new qe.BeetArgsStruct([["instructionDiscriminator",qe.u8]],"CancelAllOrdersWithFreeFundsInstructionArgs"),Wr= exports.cancelAllOrdersWithFreeFundsInstructionDiscriminator =7;function so(e,t=new Ue.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[r]=Kr.serialize({instructionDiscriminator:Wr}),o=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0}];return new Ue.TransactionInstruction({programId:t,keys:o,data:r})}var Er=new Re.FixableBeetArgsStruct([["instructionDiscriminator",Re.u8],["params",Oe]],"CancelMultipleOrdersByIdInstructionArgs"),qr= exports.cancelMultipleOrdersByIdInstructionDiscriminator =10;function lo(e,t,r=new De.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=Er.serialize(l({instructionDiscriminator:qr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:tr.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new De.TransactionInstruction({programId:r,keys:n,data:o})}var Ur=new ve.FixableBeetArgsStruct([["instructionDiscriminator",ve.u8],["params",Oe]],"CancelMultipleOrdersByIdWithFreeFundsInstructionArgs"),Rr= exports.cancelMultipleOrdersByIdWithFreeFundsInstructionDiscriminator =11;function fo(e,t,r=new Ce.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[o]=Ur.serialize(l({instructionDiscriminator:Rr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0}];return new Ce.TransactionInstruction({programId:r,keys:n,data:o})}var Dr=new Me.FixableBeetArgsStruct([["instructionDiscriminator",Me.u8],["params",Be]],"CancelUpToInstructionArgs"),vr= exports.cancelUpToInstructionDiscriminator =8;function wo(e,t,r=new Ne.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=Dr.serialize(l({instructionDiscriminator:vr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:rr.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new Ne.TransactionInstruction({programId:r,keys:n,data:o})}var Cr=new ze.FixableBeetArgsStruct([["instructionDiscriminator",ze.u8],["params",Be]],"CancelUpToWithFreeFundsInstructionArgs"),Mr= exports.cancelUpToWithFreeFundsInstructionDiscriminator =9;function Oo(e,t,r=new Ge.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[o]=Cr.serialize(l({instructionDiscriminator:Mr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0}];return new Ge.TransactionInstruction({programId:r,keys:n,data:o})}var Nr=new je.BeetArgsStruct([["instructionDiscriminator",je.u8],["depositFundsParams",Gt]],"DepositFundsInstructionArgs"),zr= exports.depositFundsInstructionDiscriminator =13;function Ko(e,t,r=new Ve.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=Nr.serialize(l({instructionDiscriminator:zr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.seat,isWritable:!1,isSigner:!1},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:ir.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new Ve.TransactionInstruction({programId:r,keys:n,data:o})}var Gr=new Ye.BeetArgsStruct([["instructionDiscriminator",Ye.u8]],"LogInstructionArgs"),Kt= exports.logInstructionDiscriminator =15;function qo(e,t=new He.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[r]=Gr.serialize({instructionDiscriminator:Kt}),o=[{pubkey:e.logAuthority,isWritable:!1,isSigner:!0}];return new He.TransactionInstruction({programId:t,keys:o,data:r})}var jr=new Ze.FixableBeetArgsStruct([["instructionDiscriminator",Ze.u8],["orderPacket",q]],"PlaceLimitOrderInstructionArgs"),Vr= exports.placeLimitOrderInstructionDiscriminator =2;function vo(e,t,r=new Xe.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=jr.serialize(l({instructionDiscriminator:Vr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.seat,isWritable:!1,isSigner:!1},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:nr.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new Xe.TransactionInstruction({programId:r,keys:n,data:o})}var Yr=new Qe.FixableBeetArgsStruct([["instructionDiscriminator",Qe.u8],["orderPacket",q]],"PlaceLimitOrderWithFreeFundsInstructionArgs"),Hr= exports.placeLimitOrderWithFreeFundsInstructionDiscriminator =3;function Go(e,t,r=new Je.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[o]=Yr.serialize(l({instructionDiscriminator:Hr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.seat,isWritable:!1,isSigner:!1}];return new Je.TransactionInstruction({programId:r,keys:n,data:o})}var Zr=new _e.FixableBeetArgsStruct([["instructionDiscriminator",_e.u8],["multipleOrderPacket",Te]],"PlaceMultiplePostOnlyOrdersInstructionArgs"),Xr= exports.placeMultiplePostOnlyOrdersInstructionDiscriminator =16;function Zo(e,t,r=new $e.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=Zr.serialize(l({instructionDiscriminator:Xr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.seat,isWritable:!1,isSigner:!1},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:or.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new $e.TransactionInstruction({programId:r,keys:n,data:o})}var Qr=new et.FixableBeetArgsStruct([["instructionDiscriminator",et.u8],["multipleOrderPacket",Te]],"PlaceMultiplePostOnlyOrdersWithFreeFundsInstructionArgs"),Jr= exports.placeMultiplePostOnlyOrdersWithFreeFundsInstructionDiscriminator =17;function $o(e,t,r=new tt.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[o]=Qr.serialize(l({instructionDiscriminator:Jr},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.seat,isWritable:!1,isSigner:!1}];return new tt.TransactionInstruction({programId:r,keys:n,data:o})}var _r=new rt.BeetArgsStruct([["instructionDiscriminator",rt.u8],["params",Ke]],"ReduceOrderInstructionArgs"),$r= exports.reduceOrderInstructionDiscriminator =4;function ns(e,t,r=new it.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=_r.serialize(l({instructionDiscriminator:$r},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:sr.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new it.TransactionInstruction({programId:r,keys:n,data:o})}var ei=new nt.BeetArgsStruct([["instructionDiscriminator",nt.u8],["params",Ke]],"ReduceOrderWithFreeFundsInstructionArgs"),ti= exports.reduceOrderWithFreeFundsInstructionDiscriminator =5;function cs(e,t,r=new ot.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[o]=ei.serialize(l({instructionDiscriminator:ti},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!0,isSigner:!0}];return new ot.TransactionInstruction({programId:r,keys:n,data:o})}var ri=new st.BeetArgsStruct([["instructionDiscriminator",st.u8]],"RequestSeatInstructionArgs"),ii= exports.requestSeatInstructionDiscriminator =14;function ms(e,t=new le.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var a;let[r]=ri.serialize({instructionDiscriminator:ii}),o=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.payer,isWritable:!0,isSigner:!0},{pubkey:e.seat,isWritable:!0,isSigner:!1},{pubkey:(a=e.systemProgram)!=null?a:le.SystemProgram.programId,isWritable:!1,isSigner:!1}];return new le.TransactionInstruction({programId:t,keys:o,data:r})}var ni=new at.FixableBeetArgsStruct([["instructionDiscriminator",at.u8],["orderPacket",q]],"SwapInstructionArgs"),oi= exports.swapInstructionDiscriminator =0;function ur(e,t,r=new ut.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=ni.serialize(l({instructionDiscriminator:oi},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:ar.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new ut.TransactionInstruction({programId:r,keys:n,data:o})}var si=new ct.FixableBeetArgsStruct([["instructionDiscriminator",ct.u8],["orderPacket",q]],"SwapWithFreeFundsInstructionArgs"),ai= exports.swapWithFreeFundsInstructionDiscriminator =1;function xs(e,t,r=new lt.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){let[o]=si.serialize(l({instructionDiscriminator:ai},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.seat,isWritable:!1,isSigner:!1}];return new lt.TransactionInstruction({programId:r,keys:n,data:o})}var ui=new bt.FixableBeetArgsStruct([["instructionDiscriminator",bt.u8],["withdrawFundsParams",$t]],"WithdrawFundsInstructionArgs"),ci= exports.withdrawFundsInstructionDiscriminator =12;function Is(e,t,r=new mt.PublicKey("PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY")){var s;let[o]=ui.serialize(l({instructionDiscriminator:ci},t)),n=[{pubkey:e.phoenixProgram,isWritable:!1,isSigner:!1},{pubkey:e.logAuthority,isWritable:!1,isSigner:!1},{pubkey:e.market,isWritable:!0,isSigner:!1},{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.baseAccount,isWritable:!0,isSigner:!1},{pubkey:e.quoteAccount,isWritable:!0,isSigner:!1},{pubkey:e.baseVault,isWritable:!0,isSigner:!1},{pubkey:e.quoteVault,isWritable:!0,isSigner:!1},{pubkey:(s=e.tokenProgram)!=null?s:cr.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1}];return new mt.TransactionInstruction({programId:r,keys:n,data:o})}var br=new y.BeetArgsStruct([["publicKey",lr.publicKey]],"PubkeyWrapper"),Pe=new y.BeetArgsStruct([["priceInTicks",y.u64],["orderSequenceNumber",y.u64]],"fIFOOrderId"),xe=new y.BeetArgsStruct([["traderIndex",y.u64],["numBaseLots",y.u64],["padding",y.uniformFixedSizeArray(y.u64,2)]],"fIFORestingOrder"),Wt=new y.BeetArgsStruct([["quoteLotsLocked",y.u64],["quoteLotsFree",y.u64],["baseLotsLocked",y.u64],["baseLotsFree",y.u64],["padding",y.uniformFixedSizeArray(y.u64,8)]],"TraderState");var yr=10,bi= exports.DEFAULT_MATCH_LIMIT =2048,dt= exports.DEFAULT_SLIPPAGE_PERCENT =.005;function Ut(e){let t=ht.byteSize,[r]=ht.deserialize(e.subarray(0,t)),o=8*32,n=e.subarray(t+o);t=0;let a=Number(n.readBigUInt64LE(t));t+=8;let s=Number(n.readBigUInt64LE(t));t+=8;let u=Number(n.readBigUInt64LE(t));t+=8;let i=Number(n.readBigUInt64LE(t));t+=8;let c=Number(n.readBigUInt64LE(t));t+=8;let m=Number(n.readBigUInt64LE(t));t+=8,n=n.subarray(t);let f=S(r.marketSizeParams.bidsSize),P=S(r.marketSizeParams.asksSize),k=S(r.marketSizeParams.numSeats),x=16+16+(16+Pe.byteSize+xe.byteSize)*f,O=16+16+(16+Pe.byteSize+xe.byteSize)*P,D=16+16+(16+32+Wt.byteSize)*k;t=0;let kt=n.subarray(t,t+x);t+=x;let Ae=n.subarray(t,t+O);t+=O;let wr=n.subarray(t,t+D),Sr=qt(kt,Pe,xe),Ar=qt(Ae,Pe,xe),hr=[...Sr].sort((de,pe)=>Lt(K(pe[0].priceInTicks).sub(K(de[0].priceInTicks)))),Ir=[...Ar].sort((de,pe)=>Lt(K(de[0].priceInTicks).sub(K(pe[0].priceInTicks)))),Ct=new Map;for(let[de,pe]of qt(wr,br,Wt))Ct.set(de.publicKey,pe);return{header:r,baseLotsPerBaseUnit:a,quoteLotsPerBaseUnitPerTick:s,sequenceNumber:u,takerFeeBps:i,collectedAdjustedQuoteLotFees:c,unclaimedAdjustedQuoteLotFees:m,bids:hr,asks:Ir,traders:Ct}}function qt(e,t,r){let o=new Map,n=0,a=t.byteSize,s=r.byteSize,u=new Array;n+=16,n+=8;let i=e.readInt32LE(n);n+=4;let c=e.readInt32LE(n);n+=4;let m=new Array;for(let x=0;n<e.length&&x<i;x++){let O=new Array;for(let Ae=0;Ae<4;Ae++)O.push(e.readInt32LE(n)),n+=4;let[D]=t.deserialize(e.subarray(n,n+a));n+=a;let[kt]=r.deserialize(e.subarray(n,n+s));n+=s,u.push([D,kt]),m.push([x,O[0]])}let f=new Set,P=c-1,k=0;for(;c!==0;)if([P,c]=m[c-1],f.add(P),k+=1,k>i)throw new Error("Infinite loop detected");for(let[x,[O,D]]of u.entries())f.has(x)||o.set(O,D);return o}function Rt(e,t=yr){let r=[],o=[];for(let[n,a]of e.bids){let s=K(n.priceInTicks),u=K(a.numBaseLots);if(r.length===0)r.push([s,u]);else{let i=r[r.length-1];if(!i)throw Error;if(s.eq(i[0]))i[1]=i[1].add(u);else{if(r.length===t)break;r.push([s,u])}}}for(let[n,a]of e.asks){let s=K(n.priceInTicks),u=K(a.numBaseLots);if(o.length===0)o.push([s,u]);else{let i=o[o.length-1];if(!i)throw Error;if(s.eq(i[0]))i[1]=i[1].add(u);else{if(o.length===t)break;o.push([s,u])}}}return{asks:o,bids:r}}function pr(e,t,r,o){return[S(t)/o*e.quoteLotsPerBaseUnitPerTick*S(e.header.quoteLotSize),S(r)/e.baseLotsPerBaseUnit]}function Dt(e,t=yr){let r=Rt(e,t),o=v(10,S(e.header.quoteParams.decimals));return{bids:r.bids.map(([n,a])=>pr(e,n,a,o)),asks:r.asks.map(([n,a])=>pr(e,n,a,o))}}function fr(e){let t=e.bids,r=e.asks,n=Math.max(...t.map(s=>s[1]),...r.map(s=>s[1])).toString().length,a=(s,u,i)=>{let c=s.toFixed(3),m=u.toFixed(2).padStart(n," ");console.log(c+`\x1B[3${i==="green"?2:1}m`+m+"\x1B[0m")};console.log("\x1B[30mAsks\x1B[0m");for(let[s,u]of r.reverse())a(s,u,"red");console.log("\x1B[30mBids\x1B[0m");for(let[s,u]of t)a(s,u,"green")}function gr({marketAddress:e,marketData:t,trader:r,side:o,inAmount:n,slippage:a=dt,clientOrderId:s=0}){let u=_web3js.PublicKey.findProgramAddressSync([r.toBuffer(),_spltoken.TOKEN_PROGRAM_ID.toBuffer(),t.header.baseParams.mintKey.toBuffer()],_spltoken.ASSOCIATED_TOKEN_PROGRAM_ID)[0],i=_web3js.PublicKey.findProgramAddressSync([r.toBuffer(),_spltoken.TOKEN_PROGRAM_ID.toBuffer(),t.header.quoteParams.mintKey.toBuffer()],_spltoken.ASSOCIATED_TOKEN_PROGRAM_ID)[0],c=_web3js.PublicKey.findProgramAddressSync([Buffer.from("log")],we)[0],m={phoenixProgram:we,logAuthority:c,market:e,trader:r,baseAccount:u,quoteAccount:i,quoteVault:t.header.quoteParams.vaultKey,baseVault:t.header.baseParams.vaultKey},f=mi({marketData:t,side:o,inAmount:n,slippage:a,clientOrderId:s}),P=ur(m,{orderPacket:l({__kind:"ImmediateOrCancel"},f)});return new (0, _web3js.Transaction)().add(P)}function mi({marketData:e,side:t,inAmount:r,slippage:o=dt,selfTradeBehavior:n=0,matchLimit:a=bi,clientOrderId:s=0,useOnlyDepositedFunds:u=!1}){let i=vt({marketData:e,side:t,inAmount:r}),c=v(10,e.header.baseParams.decimals),m=v(10,e.header.quoteParams.decimals),f=1-o,P=0,k=0,x=0,O=0;return t===1?(P=r*c/parseFloat(e.header.baseLotSize.toString()),O=Math.ceil(i*m/parseFloat(e.header.quoteLotSize.toString())*f)):(x=r*m/parseFloat(e.header.quoteLotSize.toString()),k=Math.ceil(i*c/parseFloat(e.header.baseLotSize.toString())*f)),{side:t,priceInTicks:null,numBaseLots:P,minBaseLotsToFill:k,numQuoteLots:x,minQuoteLotsToFill:O,selfTradeBehavior:n,matchLimit:a,clientOrderId:s,useOnlyDepositedFunds:u}}function vt({marketData:e,side:t,inAmount:r}){let o=S(e.header.marketSizeParams.bidsSize),n=S(e.header.marketSizeParams.asksSize),a=Dt(e,Math.max(o,n)),s=r*(1-e.takerFeeBps/1e4),u=0;if(t===0)for(let[i,c]of a.asks){let m=c*i;if(m>s){u+=s/i,s=0;break}else u+=c,s-=m}else for(let[i,c]of a.bids)if(c>s){u+=s*i,s=0;break}else u+=c*i,s-=c;return u}function pt(e){return e.includes("devnet")?"devnet":e.includes("local")||e.includes("127.0.0.1")?"localhost":"mainnet-beta"}var _borsh = require('borsh');var _bs58 = require('bs58'); var _bs582 = _interopRequireDefault(_bs58);function yt(e){return new (0, _web3js.PublicKey)(e.readFixedArray(32))}function wa(e,t){return w(this,null,function*(){var s;let r=yield e.getParsedTransaction(t,"confirmed"),o=(s=r==null?void 0:r.meta)==null?void 0:s.innerInstructions;if(!o||!r||!r.slot)return{instructions:[]};let n=[];for(let u of o)for(let i of u.instructions){if(i.programId.toBase58()!=we.toBase58())continue;let c=_bs582.default.decode(i.data);c[0]==Kt&&n.push(c.slice(1))}let a=new Array;for(let u of n){let i=new (0, _borsh.BinaryReader)(Buffer.from(u));if(i.readU8()!=1)throw new Error("early Unexpected event");let m=new Array,f=new Array,P={instruction:i.readU8(),sequenceNumber:i.readU64(),timestamp:i.readU64(),slot:i.readU64(),market:yt(i),signer:yt(i),totalEvents:i.readU16()};for(;i.offset<i.buf.length;){let k=i.readU8();switch(k){case 2:m.push({index:i.readU16(),makerId:yt(i),orderSequenceNumber:new (0, _bnjs2.default)(i.readFixedArray(8)),priceInTicks:i.readU64(),baseLotsFilled:i.readU64(),baseLotsRemaining:i.readU64()});break;case 3:m.push({index:i.readU16(),orderSequenceNumber:new (0, _bnjs2.default)(i.readFixedArray(8)),clientOrderId:i.readU64(),priceInTicks:i.readU64(),baseLotsPlaced:i.readU64()});break;case 4:m.push({index:i.readU16(),orderSequenceNumber:i.readU64(),priceInTicks:i.readU64(),baseLotsRemoved:i.readU64(),baseLotsRemaining:i.readU64()});break;case 5:m.push({index:i.readU16(),makerId:yt(i),orderSequenceNumber:i.readU64(),priceInTicks:i.readU64(),baseLotsEvicted:i.readU64()});break;case 6:m.push({index:i.readU16(),clientOrderId:i.readU128(),totalBaseLotsFilled:i.readU64(),totalQuoteLotsFilled:i.readU64(),totalFeeInQuoteLots:i.readU64()});break;case 7:m.push({index:i.readU16(),feesCollectedInQuoteLots:i.readU64()});break;default:throw Error("Unexpected Event")}f.push(k)}a.push({header:P,events:m,enums:f})}return{instructions:a}})}var Se=class{constructor({name:t,symbol:r,logoUri:o,data:n}){this.name=t,this.symbol=r,this.logoUri=o,this.data=n}};var ft={devnet:{tokens:[{name:"USD Coin",symbol:"USDC",mint:"DK1gsSV2EubSE5S5FdXHpGzw2cAJNVzxeXRmAfxAMpU5",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png"},{name:"Solana",symbol:"wSOL",mint:"B1sL3zxwyVnDGzRWCAsBkjL23wyu8HgwQP4XxgnHiSrv",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},{name:"Bonk",symbol:"Bonk",mint:"8LN9tTVkGLqXRT2SxLUjN8YRHiKzYGLq1wGV1FL7E23P",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/6dhTynDkYsVM7cbF7TKfC9DWB636TcEM935fq7JzL2ES/logo.png"}],markets:["6EvJccKnfxXvbAoCwf2iGTAEgckWuU834XAgT7tV4oxm","7EBrdSbDLvAJEMjigvSrBGkuRNdH9whvzkeojsHSVQib"]},"mainnet-beta":{tokens:[{name:"USD Coin",symbol:"USDC",mint:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png"},{name:"Wrapped SOL",symbol:"SOL",mint:"So11111111111111111111111111111111111111112",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},{name:"BASE",symbol:"BASE",mint:"7Z6Kczxo8ViRpfnsVvVaATB5fQ8bN2CQpxP8DHfd1vz5",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},{name:"QUOTE",symbol:"QUOTE",mint:"5zUmtDCDeR17UYjvKKqvYp3S9pqcZA69cDoYPtojseJ4",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"}],markets:["14CAwu3LiBBk5fcHGdTsFyVxDwvpgFiSfDwgPJxECcE5","4DoNfFBfF7UokCC2FQzriy7yHK6DY6NVdYpuekQ5pRgg"]},localhost:{tokens:[{name:"USD Coin",symbol:"USDC",mint:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png"},{name:"Wrapped SOL",symbol:"SOL",mint:"So11111111111111111111111111111111111111112",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png"},{name:"Bonk",symbol:"Bonk",mint:"DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/6dhTynDkYsVM7cbF7TKfC9DWB636TcEM935fq7JzL2ES/logo.png"}],markets:["3MZskhKUdNRkeMQ6zyNVSJcCx38o79ohwmSgZ2d5a4cu","HhHRvLFvZid6FD7C96H93F2MkASjYfYAx8Y2P8KMAr6b"]}};var be=class{constructor({name:t,address:r,baseToken:o,quoteToken:n,data:a}){this.name=t,this.address=r,this.baseToken=o,this.quoteToken=n,this.data=a}static load(o){return w(this,arguments,function*({connection:t,address:r}){let n=yield t.getAccountInfo(r);if(!n)throw new Error("Account not found for market: "+r.toBase58());let a=Buffer.from(n.data),s=Ut(a),u=ft[pt(t.rpcEndpoint)].tokens,i=u.find(k=>k.mint===s.header.baseParams.mintKey.toBase58()),c=u.find(k=>k.mint===s.header.quoteParams.mintKey.toBase58());if(i===void 0)throw new Error(`Base token ${s.header.baseParams.mintKey} not found in config`);if(c===void 0)throw new Error(`Quote token ${s.header.quoteParams.mintKey} not found in config`);let m=new Se({name:i.name,symbol:i.symbol,logoUri:i.logoUri,data:l({},s.header.baseParams)}),f=new Se({name:c.name,symbol:c.symbol,logoUri:c.logoUri,data:l({},s.header.quoteParams)});return new be({name:`${m.symbol}/${f.symbol}`,address:r,baseToken:m,quoteToken:f,data:s})})}refresh(t){return w(this,null,function*(){let r=yield t.getAccountInfo(this.address),o=Buffer.from(r.data),n=Ut(o);return this.data=n,this})}getLadder(){return Rt(this.data)}getUiLadder(){return Dt(this.data)}printLadder(){fr(this.getUiLadder())}getSwapTransaction({trader:t,side:r,inAmount:o,slippage:n=dt,clientOrderId:a=0}){return gr({marketAddress:this.address,marketData:this.data,trader:t,side:r,inAmount:o,slippage:n,clientOrderId:a})}getExpectedOutAmount({side:t,inAmount:r}){return vt({marketData:this.data,side:t,inAmount:r})}getPriceDecimalPlaces(){let t=Math.pow(10,this.data.header.quoteParams.decimals)/S(this.data.header.tickSizeInQuoteAtomsPerBaseUnit),r=0;for(;t%2===0;)t/=2,r+=1;let o=0;for(;t%5===0;)t/=5,o+=1;let n=Math.max(r,o);return Math.max(n,3)+Math.floor(Math.log10(Math.max(this.data.header.rawBaseUnitsPerBaseUnit,1)))}};var me=class{constructor(t){this.pubkey=t,this.tokenBalances={}}static create(n){return w(this,arguments,function*({connection:t,pubkey:r,tokens:o}){let a=new me(r);for(let s of o){let u=yield t.getTokenAccountsByOwner(r,{programId:_spltoken.TOKEN_PROGRAM_ID,mint:s.data.mintKey});if(u.value.length===0)continue;let i=u.value[0];a.tokenBalances[s.data.mintKey.toBase58()]=xr(i.account.data,s.data.decimals)}return a})}refresh(t){return w(this,null,function*(){return yield Promise.all(Object.keys(this.tokenBalances).map(r=>w(this,null,function*(){let n=(yield t.getTokenAccountsByOwner(this.pubkey,{programId:_spltoken.TOKEN_PROGRAM_ID,mint:new (0, _web3js.PublicKey)(r)})).value[0];this.tokenBalances[r]=xr(n.account.data,this.tokenBalances[r].decimals)}))),this})}};function xr(e,t){let o=_spltoken.AccountLayout.decode(e).amount.toString();return{amount:o,decimals:t,uiAmount:parseInt(o)/v(10,t)}}var gt=class{constructor({connection:t,tokens:r,markets:o,trader:n}){this.connection=t,this.tokens=r,this.markets=o,this.trader=n}static create(t,r){return w(this,null,function*(){let o=pt(t.rpcEndpoint),n=[],a=[];return yield Promise.all(ft[o].markets.map(s=>w(this,null,function*(){let u=yield be.load({connection:t,address:new (0, _web3js.PublicKey)(s)});n.push(u);for(let i of[u.baseToken,u.quoteToken]){let c=i.data.mintKey.toBase58();a.find(m=>m.data.mintKey.toBase58()===c)||a.push(i)}}))),new gt({connection:t,tokens:a,markets:n,trader:r?yield me.create({connection:t,pubkey:r,tokens:a}):void 0})})}};var wi="PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY",we= exports.PROGRAM_ID =new (0, _web3js.PublicKey)(wi);exports.CancelAllOrdersStruct = Tr; exports.CancelAllOrdersWithFreeFundsStruct = Kr; exports.CancelMultipleOrdersByIdStruct = Er; exports.CancelMultipleOrdersByIdWithFreeFundsStruct = Ur; exports.CancelMultipleOrdersErrorError = re; exports.CancelUpToStruct = Dr; exports.CancelUpToWithFreeFundsStruct = Cr; exports.Client = gt; exports.DEFAULT_LADDER_DEPTH = yr; exports.DEFAULT_MATCH_LIMIT = bi; exports.DEFAULT_SLIPPAGE_PERCENT = dt; exports.DepositFundsStruct = Nr; exports.EvictionErrorError = ae; exports.FailedToLoadMarketFromAccountError = N; exports.InvalidBaseAccountError = J; exports.InvalidBaseVaultError = X; exports.InvalidLotSizeError = Y; exports.InvalidMarketAuthorityError = M; exports.InvalidMarketParametersError = C; exports.InvalidMarketSignerError = V; exports.InvalidMintError = Z; exports.InvalidQuoteAccountError = _; exports.InvalidQuoteVaultError = Q; exports.InvalidSeatStatusError = se; exports.InvalidStateTransitionError = j; exports.InvalidTickSizeError = H; exports.LogStruct = Gr; exports.Market = be; exports.MarketAlreadyInitializedError = z; exports.MarketStatus = Zt; exports.MarketUninitializedError = G; exports.NewOrderErrorError = ee; exports.PROGRAM_ADDRESS = wi; exports.PROGRAM_ID = we; exports.PhoenixMarketEvent = Bt; exports.PlaceLimitOrderStruct = jr; exports.PlaceLimitOrderWithFreeFundsStruct = Yr; exports.PlaceMultiplePostOnlyOrdersStruct = Zr; exports.PlaceMultiplePostOnlyOrdersWithFreeFundsStruct = Qr; exports.ReduceOrderErrorError = te; exports.ReduceOrderStruct = _r; exports.ReduceOrderWithFreeFundsStruct = ei; exports.RemoveEmptyOrdersErrorError = ne; exports.RequestSeatStruct = ri; exports.SeatApprovalStatus = _t; exports.SelfTradeBehavior = It; exports.Side = xt; exports.SwapStruct = ni; exports.SwapWithFreeFundsStruct = si; exports.Token = Se; exports.TooManyEventsError = $; exports.Trader = me; exports.TraderNotFoundError = oe; exports.WithdrawFundsErrorError = ie; exports.WithdrawFundsStruct = ui; exports.auditLogHeaderBeet = Oi; exports.cancelAllOrdersInstructionDiscriminator = Lr; exports.cancelAllOrdersWithFreeFundsInstructionDiscriminator = Wr; exports.cancelMultipleOrdersByIdInstructionDiscriminator = qr; exports.cancelMultipleOrdersByIdParamsBeet = Oe; exports.cancelMultipleOrdersByIdWithFreeFundsInstructionDiscriminator = Rr; exports.cancelOrderParamsBeet = he; exports.cancelUpToInstructionDiscriminator = vr; exports.cancelUpToParamsBeet = Be; exports.cancelUpToWithFreeFundsInstructionDiscriminator = Mr; exports.condensedOrderBeet = wt; exports.createCancelAllOrdersInstruction = no; exports.createCancelAllOrdersWithFreeFundsInstruction = so; exports.createCancelMultipleOrdersByIdInstruction = lo; exports.createCancelMultipleOrdersByIdWithFreeFundsInstruction = fo; exports.createCancelUpToInstruction = wo; exports.createCancelUpToWithFreeFundsInstruction = Oo; exports.createDepositFundsInstruction = Ko; exports.createLogInstruction = qo; exports.createPlaceLimitOrderInstruction = vo; exports.createPlaceLimitOrderWithFreeFundsInstruction = Go; exports.createPlaceMultiplePostOnlyOrdersInstruction = Zo; exports.createPlaceMultiplePostOnlyOrdersWithFreeFundsInstruction = $o; exports.createReduceOrderInstruction = ns; exports.createReduceOrderWithFreeFundsInstruction = cs; exports.createRequestSeatInstruction = ms; exports.createSwapInstruction = ur; exports.createSwapWithFreeFundsInstruction = xs; exports.createWithdrawFundsInstruction = Is; exports.depositFundsInstructionDiscriminator = zr; exports.depositParamsBeet = Gt; exports.deserializeMarketData = Ut; exports.deserializeRedBlackTree = qt; exports.errorFromCode = Ai; exports.errorFromName = hi; exports.evictEventBeet = Mi; exports.feeEventBeet = zi; exports.fillEventBeet = ji; exports.fillSummaryEventBeet = Yi; exports.getClusterFromEndpoint = pt; exports.getEventsFromTransaction = wa; exports.getMarketExpectedOutAmount = vt; exports.getMarketLadder = Rt; exports.getMarketSwapOrderPacket = mi; exports.getMarketSwapTransaction = gr; exports.getMarketUiLadder = Dt; exports.isOrderPacketImmediateOrCancel = pn; exports.isOrderPacketLimit = dn; exports.isOrderPacketPostOnly = mn; exports.logInstructionDiscriminator = Kt; exports.marketHeaderBeet = ht; exports.marketSizeParamsBeet = Yt; exports.marketStatusBeet = tn; exports.multipleOrderPacketBeet = Te; exports.orderPacketBeet = q; exports.phoenixMarketEventBeet = fn; exports.placeEventBeet = kn; exports.placeLimitOrderInstructionDiscriminator = Vr; exports.placeLimitOrderWithFreeFundsInstructionDiscriminator = Hr; exports.placeMultiplePostOnlyOrdersInstructionDiscriminator = Xr; exports.placeMultiplePostOnlyOrdersWithFreeFundsInstructionDiscriminator = Jr; exports.printUiLadder = fr; exports.readPublicKey = yt; exports.reduceEventBeet = xn; exports.reduceOrderInstructionDiscriminator = $r; exports.reduceOrderParamsBeet = Ke; exports.reduceOrderWithFreeFundsInstructionDiscriminator = ti; exports.requestSeatInstructionDiscriminator = ii; exports.seatApprovalStatusBeet = Bn; exports.seatBeet = In; exports.selfTradeBehaviorBeet = Ot; exports.sideBeet = W; exports.sign = Lt; exports.swapInstructionDiscriminator = oi; exports.swapWithFreeFundsInstructionDiscriminator = ai; exports.toBN = K; exports.toNum = S; exports.tokenParamsBeet = At; exports.withdrawFundsInstructionDiscriminator = ci; exports.withdrawParamsBeet = $t;
