"use strict";

var _chunkHFEILVW4js = require('../../chunk-HFEILVW4.js');
require('../../chunk-A355EMTI.js');
require('../../chunk-74ANAXXV.js');
require('../../chunk-C3X3GVS5.js');
require('../../chunk-UGHO4YHY.js');
require('../../chunk-3ZYUOGD4.js');
require('../../chunk-ZYSI4CYO.js');


var _chunkS6N5Y2X2js = require('../../chunk-S6N5Y2X2.js');
require('../../chunk-772SHZWX.js');
require('../../chunk-S3PQ6OXS.js');
require('../../chunk-WKB2GIFW.js');
require('../../chunk-TBVE5N24.js');
require('../../chunk-Y7A4QF6J.js');
require('../../chunk-JC4IRQUL.js');

// ts/client/src/scripts/mm/log-perp-ob.ts
var _anchor = require('@project-serum/anchor');
var _web3js = require('@solana/web3.js');
var CLUSTER = process.env.CLUSTER_OVERRIDE || "mainnet-beta";
var CLUSTER_URL = process.env.CLUSTER_URL_OVERRIDE || process.env.MB_CLUSTER_URL;
var MANGO_ACCOUNT_PK = process.env.MANGO_ACCOUNT_PK || "";
async function main() {
  const options = _anchor.AnchorProvider.defaultOptions();
  const connection = new (0, _web3js.Connection)(CLUSTER_URL, options);
  const user = new (0, _web3js.Keypair)();
  const userWallet = new (0, _anchor.Wallet)(user);
  const userProvider = new (0, _anchor.AnchorProvider)(connection, userWallet, options);
  const client = await _chunkHFEILVW4js.MangoClient.connect(
    userProvider,
    CLUSTER,
    _chunkS6N5Y2X2js.MANGO_V4_ID[CLUSTER],
    {
      idsSource: "get-program-accounts"
    }
  );
  let mangoAccount = await client.getMangoAccount(
    new (0, _web3js.PublicKey)(MANGO_ACCOUNT_PK)
  );
  await mangoAccount.reload(client);
  const group = await client.getGroup(mangoAccount.group);
  await group.reloadAll(client);
  while (true) {
    await new Promise((r) => setTimeout(r, 2e3));
    console.clear();
    await group.reloadAll(client);
    const btcPerpMarket = group.getPerpMarketByName("BTC-PERP");
    console.log(`  perpMarket.uiPrice ${btcPerpMarket.uiPrice}`);
    console.log(``);
    console.log(await btcPerpMarket.logOb(client));
    console.log(``);
    const mngoPerpMarket = group.getPerpMarketByName("MNGO-PERP");
    console.log(`  perpMarket.uiPrice ${mngoPerpMarket.uiPrice}`);
    console.log(``);
    console.log(await mngoPerpMarket.logOb(client));
    console.log(``);
  }
}
main();
//# sourceMappingURL=log-perp-ob.js.map