{"version":3,"sources":["../ts/client/src/clientIxParamBuilder.ts"],"names":["ixGate","p"],"mappings":"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","sourcesContent":["import { BN } from '@project-serum/anchor';\nimport { PublicKey } from '@solana/web3.js';\nimport { InterestRateParams, OracleConfigParams } from './types';\n\nexport interface TokenEditParams {\n  oracle: PublicKey | null;\n  oracleConfig: OracleConfigParams | null;\n  groupInsuranceFund: boolean | null;\n  interestRateParams: InterestRateParams | null;\n  loanFeeRate: number | null;\n  loanOriginationFeeRate: number | null;\n  maintAssetWeight: number | null;\n  initAssetWeight: number | null;\n  maintLiabWeight: number | null;\n  initLiabWeight: number | null;\n  liquidationFee: number | null;\n  stablePriceDelayIntervalSeconds: number | null;\n  stablePriceDelayGrowthLimit: number | null;\n  stablePriceGrowthLimit: number | null;\n  minVaultToDepositsRatio: number | null;\n  netBorrowLimitPerWindowQuote: number | null;\n  netBorrowLimitWindowSizeTs: number | null;\n  borrowWeightScaleStartQuote: number | null;\n  depositWeightScaleStartQuote: number | null;\n  resetStablePrice: boolean | null;\n  resetNetBorrowLimit: boolean | null;\n  reduceOnly: boolean | null;\n}\n\nexport const NullTokenEditParams: TokenEditParams = {\n  oracle: null,\n  oracleConfig: null,\n  groupInsuranceFund: null,\n  interestRateParams: null,\n  loanFeeRate: null,\n  loanOriginationFeeRate: null,\n  maintAssetWeight: null,\n  initAssetWeight: null,\n  maintLiabWeight: null,\n  initLiabWeight: null,\n  liquidationFee: null,\n  stablePriceDelayIntervalSeconds: null,\n  stablePriceDelayGrowthLimit: null,\n  stablePriceGrowthLimit: null,\n  minVaultToDepositsRatio: null,\n  netBorrowLimitPerWindowQuote: null,\n  netBorrowLimitWindowSizeTs: null,\n  borrowWeightScaleStartQuote: null,\n  depositWeightScaleStartQuote: null,\n  resetStablePrice: null,\n  resetNetBorrowLimit: null,\n  reduceOnly: null,\n};\n\nexport interface PerpEditParams {\n  oracle: PublicKey | null;\n  oracleConfig: OracleConfigParams | null;\n  baseDecimals: number | null;\n  maintBaseAssetWeight: number | null;\n  initBaseAssetWeight: number | null;\n  maintBaseLiabWeight: number | null;\n  initBaseLiabWeight: number | null;\n  maintOverallAssetWeight: number | null;\n  initOverallAssetWeight: number | null;\n  baseLiquidationFee: number | null;\n  makerFee: number | null;\n  takerFee: number | null;\n  feePenalty: number | null;\n  minFunding: number | null;\n  maxFunding: number | null;\n  impactQuantity: number | null;\n  groupInsuranceFund: boolean | null;\n  settleFeeFlat: number | null;\n  settleFeeAmountThreshold: number | null;\n  settleFeeFractionLowHealth: number | null;\n  stablePriceDelayIntervalSeconds: number | null;\n  stablePriceDelayGrowthLimit: number | null;\n  stablePriceGrowthLimit: number | null;\n  settlePnlLimitFactor: number | null;\n  settlePnlLimitWindowSize: number | null;\n  reduceOnly: boolean | null;\n  resetStablePrice: boolean | null;\n  positivePnlLiquidationFee: number | null;\n}\n\nexport const NullPerpEditParams: PerpEditParams = {\n  oracle: null,\n  oracleConfig: null,\n  baseDecimals: null,\n  maintBaseAssetWeight: null,\n  initBaseAssetWeight: null,\n  maintBaseLiabWeight: null,\n  initBaseLiabWeight: null,\n  maintOverallAssetWeight: null,\n  initOverallAssetWeight: null,\n  baseLiquidationFee: null,\n  makerFee: null,\n  takerFee: null,\n  feePenalty: null,\n  minFunding: null,\n  maxFunding: null,\n  impactQuantity: null,\n  groupInsuranceFund: null,\n  settleFeeFlat: null,\n  settleFeeAmountThreshold: null,\n  settleFeeFractionLowHealth: null,\n  stablePriceDelayIntervalSeconds: null,\n  stablePriceDelayGrowthLimit: null,\n  stablePriceGrowthLimit: null,\n  settlePnlLimitFactor: null,\n  settlePnlLimitWindowSize: null,\n  reduceOnly: null,\n  resetStablePrice: null,\n  positivePnlLiquidationFee: null,\n};\n\n// Use with TrueIxGateParams and buildIxGate\nexport interface IxGateParams {\n  AccountClose: boolean;\n  AccountCreate: boolean;\n  AccountEdit: boolean;\n  AccountExpand: boolean;\n  AccountToggleFreeze: boolean;\n  AltExtend: boolean;\n  AltSet: boolean;\n  FlashLoan: boolean;\n  GroupClose: boolean;\n  GroupCreate: boolean;\n  GroupToggleHalt: boolean;\n  HealthRegion: boolean;\n  PerpCancelAllOrders: boolean;\n  PerpCancelAllOrdersBySide: boolean;\n  PerpCancelOrder: boolean;\n  PerpCancelOrderByClientOrderId: boolean;\n  PerpCloseMarket: boolean;\n  PerpConsumeEvents: boolean;\n  PerpCreateMarket: boolean;\n  PerpDeactivatePosition: boolean;\n  PerpEditMarket: boolean;\n  PerpLiqBaseOrPositivePnl: boolean;\n  PerpLiqForceCancelOrders: boolean;\n  PerpLiqNegativePnlOrBankruptcy: boolean;\n  PerpPlaceOrder: boolean;\n  PerpSettleFees: boolean;\n  PerpSettlePnl: boolean;\n  PerpUpdateFunding: boolean;\n  Serum3CancelAllOrders: boolean;\n  Serum3CancelOrder: boolean;\n  Serum3CloseOpenOrders: boolean;\n  Serum3CreateOpenOrders: boolean;\n  Serum3DeregisterMarket: boolean;\n  Serum3EditMarket: boolean;\n  Serum3LiqForceCancelOrders: boolean;\n  Serum3PlaceOrder: boolean;\n  Serum3RegisterMarket: boolean;\n  Serum3SettleFunds: boolean;\n  StubOracleClose: boolean;\n  StubOracleCreate: boolean;\n  StubOracleSet: boolean;\n  TokenAddBank: boolean;\n  TokenDeposit: boolean;\n  TokenDeregister: boolean;\n  TokenEdit: boolean;\n  TokenLiqBankruptcy: boolean;\n  TokenLiqWithToken: boolean;\n  TokenRegister: boolean;\n  TokenRegisterTrustless: boolean;\n  TokenUpdateIndexAndRate: boolean;\n  TokenWithdraw: boolean;\n}\n\n// Default with all ixs enabled, use with buildIxGate\nexport const TrueIxGateParams: IxGateParams = {\n  AccountClose: true,\n  AccountCreate: true,\n  AccountEdit: true,\n  AccountExpand: true,\n  AccountToggleFreeze: true,\n  AltExtend: true,\n  AltSet: true,\n  FlashLoan: true,\n  GroupClose: true,\n  GroupCreate: true,\n  GroupToggleHalt: true,\n  HealthRegion: true,\n  PerpCancelAllOrders: true,\n  PerpCancelAllOrdersBySide: true,\n  PerpCancelOrder: true,\n  PerpCancelOrderByClientOrderId: true,\n  PerpCloseMarket: true,\n  PerpConsumeEvents: true,\n  PerpCreateMarket: true,\n  PerpDeactivatePosition: true,\n  PerpEditMarket: true,\n  PerpLiqBaseOrPositivePnl: true,\n  PerpLiqForceCancelOrders: true,\n  PerpLiqNegativePnlOrBankruptcy: true,\n  PerpPlaceOrder: true,\n  PerpSettleFees: true,\n  PerpSettlePnl: true,\n  PerpUpdateFunding: true,\n  Serum3CancelAllOrders: true,\n  Serum3CancelOrder: true,\n  Serum3CloseOpenOrders: true,\n  Serum3CreateOpenOrders: true,\n  Serum3DeregisterMarket: true,\n  Serum3EditMarket: true,\n  Serum3LiqForceCancelOrders: true,\n  Serum3PlaceOrder: true,\n  Serum3RegisterMarket: true,\n  Serum3SettleFunds: true,\n  StubOracleClose: true,\n  StubOracleCreate: true,\n  StubOracleSet: true,\n  TokenAddBank: true,\n  TokenDeposit: true,\n  TokenDeregister: true,\n  TokenEdit: true,\n  TokenLiqBankruptcy: true,\n  TokenLiqWithToken: true,\n  TokenRegister: true,\n  TokenRegisterTrustless: true,\n  TokenUpdateIndexAndRate: true,\n  TokenWithdraw: true,\n};\n\n// build ix gate e.g. buildIxGate(Builder(TrueIxGateParams).TokenDeposit(false).build()).toNumber(),\nexport function buildIxGate(p: IxGateParams): BN {\n  const ixGate = new BN(0);\n\n  function toggleIx(\n    ixGate: BN,\n    p: IxGateParams,\n    propName: string,\n    index: number,\n  ): void {\n    if (p[propName] === undefined) {\n      throw new Error(`Unknown property ${propName}`);\n    }\n    ixGate.ior(p[propName] ? new BN(0) : new BN(1).ushln(index));\n  }\n  toggleIx(ixGate, p, 'AccountClose', 0);\n  toggleIx(ixGate, p, 'AccountCreate', 1);\n  toggleIx(ixGate, p, 'AccountEdit', 2);\n  toggleIx(ixGate, p, 'AccountExpand', 3);\n  toggleIx(ixGate, p, 'AccountToggleFreeze', 4);\n  toggleIx(ixGate, p, 'AltExtend', 5);\n  toggleIx(ixGate, p, 'AltSet', 6);\n  toggleIx(ixGate, p, 'FlashLoan', 7);\n  toggleIx(ixGate, p, 'GroupClose', 8);\n  toggleIx(ixGate, p, 'GroupCreate', 9);\n  toggleIx(ixGate, p, 'HealthRegion', 10);\n  toggleIx(ixGate, p, 'PerpCancelAllOrders', 11);\n  toggleIx(ixGate, p, 'PerpCancelAllOrdersBySide', 12);\n  toggleIx(ixGate, p, 'PerpCancelOrder', 13);\n  toggleIx(ixGate, p, 'PerpCancelOrderByClientOrderId', 14);\n  toggleIx(ixGate, p, 'PerpCloseMarket', 15);\n  toggleIx(ixGate, p, 'PerpConsumeEvents', 16);\n  toggleIx(ixGate, p, 'PerpCreateMarket', 17);\n  toggleIx(ixGate, p, 'PerpDeactivatePosition', 18);\n  toggleIx(ixGate, p, 'PerpLiqBaseOrPositivePnl', 19);\n  toggleIx(ixGate, p, 'PerpLiqForceCancelOrders', 20);\n  toggleIx(ixGate, p, 'PerpLiqNegativePnlOrBankruptcy', 21);\n  toggleIx(ixGate, p, 'PerpPlaceOrder', 22);\n  toggleIx(ixGate, p, 'PerpSettleFees', 23);\n  toggleIx(ixGate, p, 'PerpSettlePnl', 24);\n  toggleIx(ixGate, p, 'PerpUpdateFunding', 25);\n  toggleIx(ixGate, p, 'Serum3CancelAllOrders', 26);\n  toggleIx(ixGate, p, 'Serum3CancelOrder', 27);\n  toggleIx(ixGate, p, 'Serum3CloseOpenOrders', 28);\n  toggleIx(ixGate, p, 'Serum3CreateOpenOrders', 29);\n  toggleIx(ixGate, p, 'Serum3DeregisterMarket', 30);\n  toggleIx(ixGate, p, 'Serum3EditMarket', 31);\n  toggleIx(ixGate, p, 'Serum3LiqForceCancelOrders', 32);\n  toggleIx(ixGate, p, 'Serum3PlaceOrder', 33);\n  toggleIx(ixGate, p, 'Serum3RegisterMarket', 34);\n  toggleIx(ixGate, p, 'Serum3SettleFunds', 35);\n  toggleIx(ixGate, p, 'StubOracleClose', 36);\n  toggleIx(ixGate, p, 'StubOracleCreate', 37);\n  toggleIx(ixGate, p, 'StubOracleSet', 38);\n  toggleIx(ixGate, p, 'TokenAddBank', 39);\n  toggleIx(ixGate, p, 'TokenDeposit', 40);\n  toggleIx(ixGate, p, 'TokenDeregister', 41);\n  toggleIx(ixGate, p, 'TokenLiqBankruptcy', 42);\n  toggleIx(ixGate, p, 'TokenLiqWithToken', 43);\n  toggleIx(ixGate, p, 'TokenRegister', 44);\n  toggleIx(ixGate, p, 'TokenRegisterTrustless', 45);\n  toggleIx(ixGate, p, 'TokenUpdateIndexAndRate', 46);\n  toggleIx(ixGate, p, 'TokenWithdraw', 47);\n\n  return ixGate;\n}\n"]}